import{d as e,G as a,l,C as s,E as o,o as u,e as t,a as n,f as d,T as c,I as i,H as r,J as v,K as m,L as p,c as g,w as f,g as _,b as k,F as h,k as y,m as C,A as V,M as I,N as b,O as x,D as N}from"./index-DyGdzgXE.js";import{f as j,h as w,i as U,j as L,k as q,l as J}from"./index.DaLwyaZi.js";import{_ as O}from"./plugin-vueexport-helper.BCo6x5W8.js";import{a as S}from"./uni-app.es.CvrS4dlG.js";const T=O(e({__name:"CodeLogin",props:{modelValue:{},modelModifiers:{}},emits:a(["changeCode"],["update:modelValue"]),setup(e,{emit:a}){const r=a,v=l("");s(v,(()=>{r("changeCode",v.value),console.log(v.value)}));const m=o(e,"modelValue");return(e,a)=>{const l=i;return u(),t(c,{to:"body"},[n("div",{class:"whole"},[n("p",null,[n("span",{onClick:a[0]||(a[0]=e=>m.value=!m.value)},"收起")]),n("p",{class:"getCode"},[d(l,{type:"text",modelValue:v.value,"onUpdate:modelValue":a[1]||(a[1]=e=>v.value=e),placeholder:"请输入验证码"},null,8,["modelValue"]),n("span",null,"重新获取验证码?")])])])}}}),[["__scopeId","data-v-0053f6ed"]]),A=O(e({__name:"QRcodeLogin",setup(e){r({url:"/api/login/refresh"});const a=l(0),s={};S((()=>{clearInterval(a.value)})),v((()=>{clearInterval(a.value)}));const o=l("");return j().then((e=>{const l=e.data.data.unikey;w(e.data.data.unikey).then((e=>{o.value=e.data.data.qrimg,a.value=setInterval((()=>{U(l).then((e=>{console.log(e.data),802===e.data.code&&console.log(e),803===e.data.code&&(console.log(e.data),s.cookie=e.data.cookie,console.log(s),m({key:"userInfo",data:JSON.stringify(s),success:function(){p({url:"/pages/index/index"})}}),r({url:"/api/login/refresh"}),clearInterval(a.value)),800===e.data.code&&clearInterval(a.value)}))}),1e3)}))})),(e,a)=>(u(),t(c,{to:"body"},[n("div",{class:"whole"},[n("img",{src:o.value,alt:""},null,8,["src"])])]))}}),[["__scopeId","data-v-100d3aa2"]]),D=O(e({__name:"login",setup(e){const a=l(!0),o=l(""),c=l(!1),r=l(!1),v=l(!1),j=l(!1),w=()=>{o.value=""},U=l(0),O=e=>{U.value=e};s(U,(()=>{4===String(U.value).length&&J(Number(o.value),U.value).then((e=>{console.log(e),e.data.data&&p({url:"/pages/index/index"})}))}));const S=async()=>{if(!c.value)return void(r.value=!0);console.log(Number(o.value));/^1[3,4,5,6,7,8,9]\d{9}$/.test(o.value)?(v.value=!0,L(Number(o.value))):alert("请输入正确的手机号码")},D=()=>{c.value=!0};s(o,(()=>{a.value=o.value.length>0}),{immediate:!0});const H=async()=>{if(!c.value)return void(r.value=!0);const e=await q();if(200===e.data.code){console.log(e.data.userId);const a={cookie:e.data.cookie,createTime:e.data.createTime,userId:e.data.userId};m({key:"userInfo",data:JSON.stringify(a),success:function(){p({url:"/pages/index/index"})}})}};return(e,l)=>{const s=y,m=C,p=i,U=N,L=V,q=I,J=b,M=x;return u(),g(h,null,[n("div",{class:"whole"},[n("div",{class:"app"},[d(s,null,{default:f((()=>[n("img",{src:"/musical-engine/assets/music-DUeqHshX.png"})])),_:1})]),n("div",{class:"login"},[d(s,{class:"uni-form-item"},{default:f((()=>[d(m,{class:"countrycode"},{default:f((()=>[_("+86")])),_:1}),d(p,{class:"uni-input",type:"tel",modelValue:o.value,"onUpdate:modelValue":l[0]||(l[0]=e=>o.value=e),focus:"",placeholder:"请输入手机号"},null,8,["modelValue"]),a.value?(u(),t(U,{key:0,type:"clear",size:"26",onClick:w})):k("",!0)])),_:1}),d(L,{class:"quickLogin",onClick:S},{default:f((()=>[_("验证码登录")])),_:1}),d(s,{class:"agreement"},{default:f((()=>[d(M,{onChange:l[1]||(l[1]=e=>c.value=!c.value)},{default:f((()=>[d(J,{class:"label"},{default:f((()=>[d(q,{class:"checkbox",checked:c.value},null,8,["checked"]),_("我已阅读 ")])),_:1})])),_:1})])),_:1}),d(s,{onClick:l[2]||(l[2]=e=>j.value=!0)},{default:f((()=>[_("二维码登录")])),_:1})]),d(s,{class:"tourist",onClick:H},{default:f((()=>[_("立即体验")])),_:1}),r.value?(u(),t(s,{key:0,class:"dialog",onClick:l[3]||(l[3]=e=>r.value=!r.value)},{default:f((()=>[d(s,{class:"btns"},{default:f((()=>[d(s,{class:"tip"},{default:f((()=>[d(m,null,{default:f((()=>[_("同意协议后登录")])),_:1})])),_:1}),d(s,{class:"agree"},{default:f((()=>[d(L,{class:"button noAgree"},{default:f((()=>[_("不同意")])),_:1}),d(L,{class:"button agree",onClick:D},{default:f((()=>[_("同意并继续")])),_:1})])),_:1})])),_:1})])),_:1})):k("",!0)]),v.value?(u(),t(T,{key:0,modelValue:v.value,"onUpdate:modelValue":l[4]||(l[4]=e=>v.value=e),onChangeCode:O},null,8,["modelValue"])):k("",!0),j.value?(u(),t(A,{key:1,modelValue:j.value,"onUpdate:modelValue":l[5]||(l[5]=e=>j.value=e)},null,8,["modelValue"])):k("",!0)],64)}}}),[["__scopeId","data-v-f0385b03"]]);export{D as default};
